// prisma/schema.prisma

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}



/* =====================
   AUTH CORE MODELS
===================== */

enum Role {
  EXECUTIVE
  DEPARTMENT
  ADMIN
}

model Hospital {
  id                String                @id @default(uuid())
  name              String
  region            String?
  administratorName String?
  createdAt         DateTime              @default(now())

  users             User[]
  admissions        AdmissionsDaily[]
  departmentCapacity DepartmentCapacity[]
  staffDailyStatus  StaffDailyStatus[]
  predictions       PredictionsDaily[]
  alerts            Alert[]
  reports           ReportGenerated[]
  patients          Patient[]
}

/**
 * Users used for login/signup
 */
model User {
  id         String   @id @default(uuid())
  fullName   String
  email      String   @unique
  password   String
  role       Role
  hospitalId String?
  hospital   Hospital? @relation(fields: [hospitalId], references: [id])

  createdAt  DateTime @default(now())
}

/* =====================
   2. admissions_daily
===================== */

model AdmissionsDaily {
  id                     BigInt   @id @default(autoincrement())
  date                   DateTime
  hospitalId             String
  hospital               Hospital  @relation(fields: [hospitalId], references: [id])

  totalAdmissions        Int
  emergencyAdmissions    Int
  scheduledAdmissions    Int
  icuAdmissions          Int
  generalWardAdmissions  Int
  outpatientVisits       Int
  avgLengthOfStayDays    Float
  totalDischarges        Int
  bedOccupancyPercent    Float
  surgeFlag              Boolean

  createdAt              DateTime @default(now())
}

/* =====================
   3. weather_daily
===================== */

model WeatherDaily {
  id               BigInt   @id @default(autoincrement())
  date             DateTime
  city             String
  temperatureMax   Float
  temperatureMin   Float
  temperatureAvg   Float
  humidityPercent  Float
  rainfallMm       Float
  windSpeedKmph    Float
  weatherCondition String
  season           String
  heatIndex        Float
  uvIndex          Float
  visibilityKm     Float
}

/* =====================
   4. aqi_daily
===================== */

model AqiDaily {
  id             BigInt   @id @default(autoincrement())
  date           DateTime
  city           String
  location       String
  aqi            Int
  pm25           Float
  pm10           Float
  no2            Float
  so2            Float
  co             Float
  o3             Float
  category       String
  healthAdvisory String
}

/* =====================
   5. festivals
===================== */

model Festival {
  id                        BigInt   @id @default(autoincrement())
  festivalName              String
  date                      DateTime
  month                     String
  durationDays              Int
  region                    String
  expectedCrowdSize         String
  riskLevel                 String
  affectedDepartments       String
  primaryHealthRisks        String
  historicalSurgePercentage Float
  mobilityIndex             String
  weatherImpact             String
}

/* =============================
   6. department_capacity
============================= */

model DepartmentCapacity {
  id                      BigInt   @id @default(autoincrement())
  hospitalId              String
  hospital                Hospital @relation(fields: [hospitalId], references: [id])

  departmentName          String
  totalBeds               Int
  icuBeds                 Int
  generalBeds             Int
  currentOccupancyCount   Int
  occupancyPercent        Float
  ventilatorsTotal        Int
  ventilatorsAvailable    Int
  oxygenPoints            Int
  monitoringEquipmentCount Int
  staffCount              Int
  doctorsCount            Int
  nursesCount             Int
  supportStaffCount       Int
  equipmentStatus         String
  expansionCapacityBeds   Int
}

/* =============================
   7. staff_daily_status
============================= */

model StaffDailyStatus {
  id                BigInt   @id @default(autoincrement())
  hospitalId        String
  hospital          Hospital @relation(fields: [hospitalId], references: [id])

  date              DateTime
  role              String
  department        String
  totalStaff        Int
  availableStaff    Int
  onCallStaff       Int
  sickLeaveCount    Int
  overtimeHours     Float
  utilizationPercent Float
}

/* =============================
   8. patients
============================= */

model Patient {
  id                String   @id @default(uuid())
  patientId         String
  hospitalId        String?
  hospital          Hospital? @relation(fields: [hospitalId], references: [id])

  admissionDate     DateTime
  age               Int
  gender            String
  admissionType     String
  admissionReason   String
  primaryDiagnosis  String
  severity          String
  comorbidities     String
  department        String
  lengthOfStayDays  Int
  outcome           String
  insuranceStatus   String
  treatmentCost     Float
  seasonAdmitted    String
}

/* =============================
   9. predictions_daily
============================= */

model PredictionsDaily {
  id                        BigInt   @id @default(autoincrement())
  date                      DateTime
  hospitalId                String
  hospital                  Hospital @relation(fields: [hospitalId], references: [id])

  predictedTotalAdmissions  Int
  predictedIcuLoad          Int
  predictedEmergencyLoad    Int
  predictedOccupancy        Float
  surgeProbability          Float
  modelVersion              String
  createdAt                 DateTime @default(now())
}

/* =============================
   10. alerts
============================= */

model Alert {
  id             String   @id @default(uuid())
  hospitalId     String
  hospital       Hospital @relation(fields: [hospitalId], references: [id])

  timestamp      DateTime
  alertType      String
  severity       String
  message        String
  acknowledged   Boolean  @default(false)
  acknowledgedBy String?
}

/* =============================
   11. reports_generated
============================= */

model ReportGenerated {
  id          BigInt   @id @default(autoincrement())
  date        DateTime
  hospitalId  String
  hospital    Hospital @relation(fields: [hospitalId], references: [id])

  reportType  String
  filePath    String
  generatedAt DateTime @default(now())
}
